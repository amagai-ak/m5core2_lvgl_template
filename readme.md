# M5Stack Core2でLVGLを使うためのテンプレート

platformio用．

## 基本的な考え方

ScreenBaseクラスから，用途毎に各スクリーンを派生させ，1画面=1インスタンスを作る．
その画面をScreenManagerに登録することで，画面の切り替えを行えるようにする．

## 編集が必要なファイル

screen_id.h を編集し，スクリーンのID一覧を定義する．

## main.cppの流れ

### setup()
M5stackの初期化を行い，さらに，lvgl_setup() を呼び出してLGVLの初期化を行う．
次に，各スクリーンのインスタンスを初期化し，ScreenManagerに登録．

### loop()
各種処理(センサの読み出し等)を行い，さらに，ScreenManagerのloop()を呼び出す．これで，現在表示中のスクリーンのloop()が呼ばれる．


## ScreenBase クラス

スクリーンを作成するとき，このクラスから派生させる．

### setup()

初期設定．必ず最初に，親クラスのsetup()を呼ぶこと．

画面を構成するLVGLのパーツ類をここで作成する．

### loop()

スクリーンがアクティブである間，繰り返し呼ばれる関数．画面の更新用．
スクリーンを切り替えて，他のスクリーンが表示されている場合には呼び出されない．

### on_load()

画面切り替えの際，画面が表示される直前に呼び出される．
描画状態の再初期化等を行いたい場合に実装する．

### on_unload()

画面切り替えの際，画面が表示対象から外される直前に呼び出される．


## ScreenManager クラス

複数のスクリーンの切り替えを行う．

add_screen()で，スクリーンIDと，スクリーンのインスタンスを登録する．

loop() を呼ぶことで，現在表示中のスクリーンのloop()を呼び出す．

change_screen()を呼ぶことで，スクリーンの切り替えを行う．

## フォント

等幅フォントの作成に，Myricaを使用．
https://myrica.estable.jp/

